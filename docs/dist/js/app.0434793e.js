(function(t){function e(e){for(var i,l,r=e[0],n=e[1],c=e[2],u=0,m=[];u<r.length;u++)l=r[u],Object.prototype.hasOwnProperty.call(s,l)&&s[l]&&m.push(s[l][0]),s[l]=0;for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);d&&d(e);while(m.length)m.shift()();return a.push.apply(a,c||[]),o()}function o(){for(var t,e=0;e<a.length;e++){for(var o=a[e],i=!0,r=1;r<o.length;r++){var n=o[r];0!==s[n]&&(i=!1)}i&&(a.splice(e--,1),t=l(l.s=o[0]))}return t}var i={},s={app:0},a=[];function l(e){if(i[e])return i[e].exports;var o=i[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,l),o.l=!0,o.exports}l.m=t,l.c=i,l.d=function(t,e,o){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(l.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)l.d(o,i,function(e){return t[e]}.bind(null,i));return o},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/pelis/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],n=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=n;a.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"034f":function(t,e,o){"use strict";o("85ec")},"56d7":function(t,e,o){"use strict";o.r(e);var i=o("2b0e"),s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("Nav"),o("b-container",[o("b-row",[o("b-col",{attrs:{sm:"12",lg:"4"}},[o("Resume",{attrs:{totalSpent:t.totalSpent,totalMovies:t.totalMovies(),giftMovies:t.giftMovies(),unwatchedMovies:t.unwatchedMovies()}}),o("b-alert",{staticClass:"d-none d-sm-block",attrs:{variant:"light",show:""}},[o("strong",[t._v("Añadir película")]),o("hr"),o("b-input-group",{attrs:{size:"md",prepend:"Título"}},[o("b-form-input",{attrs:{id:"new-movie-title"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addMovie.apply(null,arguments)}},model:{value:t.addMovieData.title,callback:function(e){t.$set(t.addMovieData,"title",e)},expression:"addMovieData.title"}})],1),o("b-input-group",{staticClass:"mt-2",attrs:{size:"md",prepend:"Precio",append:"€"}},[o("b-form-input",{on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addMovie.apply(null,arguments)}},model:{value:t.addMovieData.cost,callback:function(e){t.$set(t.addMovieData,"cost",e)},expression:"addMovieData.cost"}})],1),o("b-input-group",{staticClass:"mt-2",attrs:{prepend:"Tienda"}},[o("b-form-select",{model:{value:t.addMovieData.store,callback:function(e){t.$set(t.addMovieData,"store",e)},expression:"addMovieData.store"}},[o("b-form-select-option",{attrs:{value:""}}),t._l(t.stores,(function(e,i){return o("b-form-select-option",{key:i,attrs:{value:i}},[t._v(t._s(e))])}))],2)],1),o("b-button",{staticClass:"mt-2",attrs:{block:"",size:"md",variant:"success"},on:{click:t.addMovie}},[t._v("Añadir a la colección")])],1)],1),t._v(" "),o("b-col",{attrs:{sm:"12",lg:"8"}},[o("SuggestedMovie",{on:{showDetail:t.showMovieModal}}),t.filteredResults.count?o("b-pagination",{staticClass:"mb-3",attrs:{"total-rows":t.filteredResults.count,"per-page":t.qtyPerPage,limit:10,align:"fill"},on:{change:t.changePage},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}}):t._e(),o("b-list-group",[o("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center",attrs:{variant:"dark"}},[o("h4",{staticClass:"mb-0 d-inline-block"},[t._v("Mi colección")]),o("b-button",{attrs:{size:"sm",variant:t.showFilters?"light":""},on:{click:function(e){t.showFilters=!t.showFilters}}},[o("b-icon-filter")],1)],1),t.showFilters?o("b-list-group-item",{attrs:{variant:"light"}},[o("b-row",[o("b-col",{attrs:{cols:"12"}},[o("b-input-group",{attrs:{size:"md",prepend:"Título"}},[o("b-form-input",{model:{value:t.filters.title,callback:function(e){t.$set(t.filters,"title",e)},expression:"filters.title"}})],1)],1)],1),o("b-row",{staticClass:"mt-2"},[o("b-col",{attrs:{cols:"12",md:"5"}},[o("b-input-group",{attrs:{prepend:"Precio"}},[o("b-form-select",{model:{value:t.filters.cost,callback:function(e){t.$set(t.filters,"cost",e)},expression:"filters.cost"}},[o("b-form-select-option",{attrs:{value:""}}),o("b-form-select-option",{attrs:{value:"0"}},[t._v("Gratis")]),o("b-form-select-option",{attrs:{value:"<5"}},[t._v("< 5€")]),o("b-form-select-option",{attrs:{value:"<10"}},[t._v("< 10€")]),o("b-form-select-option",{attrs:{value:"10&50"}},[t._v("> 10€ && < 50€")]),o("b-form-select-option",{attrs:{value:">50"}},[t._v("> 50€")])],1)],1)],1),o("b-col",{staticClass:"mt-2 mt-sm-0",attrs:{cols:"12",md:"5"}},[o("b-input-group",{attrs:{prepend:"Estrenada"}},[o("b-form-select",{model:{value:t.filters.watched,callback:function(e){t.$set(t.filters,"watched",e)},expression:"filters.watched"}},[o("b-form-select-option",{attrs:{value:null}},[t._v("Todas")]),o("b-form-select-option",{attrs:{value:!1}},[t._v("Sin estrenar")]),o("b-form-select-option",{attrs:{value:!0}},[t._v("Estrenadas")])],1)],1)],1)],1),o("b-row",{staticClass:"mt-2 text-center"},[o("b-col",[o("b-input-group",{attrs:{prepend:"Resultados por página"}},[o("b-form-select",{model:{value:t.qtyPerPage,callback:function(e){t.qtyPerPage=e},expression:"qtyPerPage"}},[o("b-form-select-option",{attrs:{value:15}},[t._v("15")]),o("b-form-select-option",{attrs:{value:50}},[t._v("50")]),o("b-form-select-option",{attrs:{value:100}},[t._v("100")])],1)],1)],1),o("b-col",[o("b-input-group",{attrs:{prepend:"Ordenar"}},[o("b-form-select",{model:{value:t.filters.sort.field,callback:function(e){t.$set(t.filters.sort,"field",e)},expression:"filters.sort.field"}},[o("b-form-select-option",{attrs:{value:"title"}},[t._v("Título")]),o("b-form-select-option",{attrs:{value:"cost"}},[t._v("Coste")]),o("b-form-select-option",{attrs:{value:"addDate"}},[t._v("Fecha añadida")])],1),o("b-form-select",{model:{value:t.filters.sort.order,callback:function(e){t.$set(t.filters.sort,"order",e)},expression:"filters.sort.order"}},[o("b-form-select-option",{attrs:{value:1}},[t._v("Asc")]),o("b-form-select-option",{attrs:{value:-1}},[t._v("Desc")])],1)],1)],1)],1),o("b-row",[o("b-col",[t._v("Resultados: "),o("strong",[t._v(t._s(t.filteredResults.count))])])],1)],1):t._e(),t.totalMovies()?t._e():o("b-list-group-item",{attrs:{variant:"secondary"}},[t._v("Aún no has añadido nada a tu colección :(")]),t.hasAnyFilter&&!t.filteredResults.count&&t.totalMovies()?o("b-list-group-item",{attrs:{variant:"warning"}},[t._v("No hay resultados con estos filtros")]):t._e(),t._l(t.filteredResults.items,(function(e,i){return o("b-list-group-item",{key:i},[o("b-row",[o("b-col",{attrs:{md:"12"}},[o("div",{staticClass:"text-truncate text-left font-weight-bold"},[o("a",{directives:[{name:"b-modal",rawName:"v-b-modal.detail-movie-modal",modifiers:{"detail-movie-modal":!0}}],attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),t.showMovie(e.id)}}},[t._v(t._s(e.title))])])]),o("b-col",{staticClass:"text-right",attrs:{md:"12"}},[o("b-row",{staticClass:"mt-3 mt-sm-0"},[o("b-col",{attrs:{cols:"6",sm:"8"}},[o("div",{staticClass:"mt-1 text-left"},[+e.watched?t._e():o("b-badge",{staticClass:"mr-2 pl-2 pr-2 text-uppercase",attrs:{variant:"warning"}},[t._v("Sin estrenar")]),o("b-badge",{staticClass:"mr-2 pl-2 pr-2",attrs:{variant:"success",title:"Coste: "+e.cost+"€"}},[t._v(t._s(e.cost)+"€")]),o("b-badge",{staticClass:"mr-2 pl-2 pr-2",attrs:{variant:"secondary",title:"Añadida: "+t.formatDate(e.addDate)}},[t._v(t._s(t.formatDate(e.addDate)))])],1)]),o("b-col",{attrs:{cols:"6",sm:"4"}},[o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.edit-movie",modifiers:{"edit-movie":!0}}],staticClass:"mr-1",attrs:{variant:"info",size:"sm"},on:{click:function(o){return t.editMovie(e.id)}}},[o("b-icon-pencil"),t._v(" "),o("span",{staticClass:"d-none d-sm-inline-block"},[t._v("Editar")])],1),o("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(o){return t.removeMovie(e.id)}}},[o("b-icon-trash"),t._v(" "),o("span",{staticClass:"d-none d-sm-inline-block"},[t._v("Eliminar")])],1)],1)],1)],1)],1)],1)}))],2),t.filteredResults.count?o("b-pagination",{staticClass:"mt-3",attrs:{"total-rows":t.filteredResults.count,"per-page":t.qtyPerPage,limit:10,align:"fill"},on:{change:t.changePage},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}}):t._e()],1)],1)],1),o("AddMovieModal"),o("OptionsModal"),o("EditModal",{attrs:{movie:t.editMovieData},on:{confirmEditMovie:t.confirmEditMovie,resetEditMovie:t.resetEditMovie}}),o("DetailModal",{attrs:{movie:t.detailMovie},on:{removeMovie:function(e){return t.removeMovie(e)},editMovie:function(e){return t.editMovie(e)}}})],1)},a=[],l=o("2f62"),r=(o("f9e3"),o("2dd8"),o("5df9"),{methods:{showToast(t,e,o){this.$bvToast.toast(e,{title:t,variant:o,solid:!0,toaster:"b-toaster-top-center"})},newId(){return Math.random().toString().substring(2)+(new Date).getTime()}}}),n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.movie.id?o("b-card",{staticClass:"mb-3"},[o("b-card-text",[o("strong",{staticClass:"mr-1"},[t._v("Película sugerida hoy:")]),o("a",{staticClass:"font-weight-bold",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.$emit("showDetail",t.movie.id)}}},[t._v(t._s(t.movie.title))]),+t.movie.watched?t._e():o("b-badge",{staticClass:"ml-1",attrs:{variant:"warning"}},[t._v("SIN ESTRENAR")])],1)],1):t._e()},c=[],d={name:"SuggestedMovie",computed:{...Object(l["b"])(["movieCollection","suggestedToday"])},watch:{suggestedToday(){this.$store.dispatch({type:"getMovie",id:this.suggestedToday.id}).then(t=>this.movie=t)}},data:function(){return{movie:{}}},mounted(){}},u=d,m=o("2877"),v=Object(m["a"])(u,n,c,!1,null,"34eaa686",null),p=v.exports,f=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.movie?o("b-modal",{attrs:{size:"lg",id:"detail-movie-modal",title:"Detalle: "+t.movie["Título"],"ok-only":""}},[o("b-container",{attrs:{id:"detail-content"}},[t._l(t.movie,(function(e,i){return o("b-row",{key:i},[o("b-col",{staticClass:"text-right",attrs:{cols:"4"}},[o("strong",[t._v(t._s(i))])]),o("b-col",{attrs:{cols:"8"}},["ID"===i?o("code",{staticClass:"text-truncate d-block"},[t._v(t._s(e))]):o("span",[t._v(t._s(e))])])],1)})),t.suggestedToday&&t.suggestedToday.id===t.movie.ID?o("b-row",[o("b-col",{attrs:{cols:"4"}}),o("b-col",{staticClass:"text-left"},[o("b-badge",{attrs:{variant:"info"}},[t._v("SUGERIDA HOY")])],1)],1):t._e(),o("hr"),o("b-row",[o("b-col",{staticClass:"text-right",attrs:{cols:"4"}},[t._v(" Opciones ")]),o("b-col",[o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.edit-movie",modifiers:{"edit-movie":!0}}],staticClass:"mr-1",attrs:{variant:"info",size:"sm"},on:{click:function(e){return t.$emit("editMovie",t.movie.ID)}}},[o("b-icon-pencil"),t._v(" "),o("span",{staticClass:"d-none d-sm-inline-block"},[t._v("Editar")])],1),o("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(e){return t.$emit("removeMovie",t.movie.ID)}}},[o("b-icon-trash"),t._v(" "),o("span",{staticClass:"d-none d-sm-inline-block"},[t._v("Eliminar")])],1)],1)],1)],2)],1):t._e()},b=[],h={name:"DetailModal",props:["movie"],computed:{...Object(l["b"])(["suggestedToday"])}},g=h,w=Object(m["a"])(g,f,b,!1,null,null,null),C=w.exports,_=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-modal",{attrs:{id:"edit-movie",title:"Editar película"},on:{ok:function(e){return t.$emit("confirmEditMovie")},hidden:function(e){return t.$emit("resetEditMovie")}}},[o("b-row",[o("b-col",{attrs:{cols:"12"}},[t._v("id: "),o("code",[t._v(t._s(t.movie.id))])])],1),o("b-row",{staticClass:"mt-3"},[o("b-col",{attrs:{cols:"12"}},[o("b-input-group",{attrs:{size:"md",prepend:"Título"}},[o("b-form-input",{attrs:{id:"new-movie-title"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$emit("confirmEditMovie")}},model:{value:t.movie.title,callback:function(e){t.$set(t.movie,"title",e)},expression:"movie.title"}})],1)],1),o("b-col",{staticClass:"mt-2",attrs:{cols:"12",sm:"6"}},[o("b-input-group",{attrs:{size:"md",prepend:"Precio",append:"€"}},[o("b-form-input",{on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$emit("confirmEditMovie")}},model:{value:t.movie.cost,callback:function(e){t.$set(t.movie,"cost",e)},expression:"movie.cost"}})],1)],1),o("b-col",{staticClass:"mt-2",attrs:{cols:"12",sm:"6"}},[o("b-input-group",{attrs:{prepend:"Tienda"}},[o("b-form-select",{model:{value:t.movie.store,callback:function(e){t.$set(t.movie,"store",e)},expression:"movie.store"}},[o("b-form-select-option",{attrs:{value:""}}),t._l(t.stores,(function(e,i){return o("b-form-select-option",{key:i,attrs:{value:i}},[t._v(t._s(e))])}))],2)],1)],1)],1),o("b-row",{staticClass:"mt-2"},[o("b-col",[o("b-input-group",{attrs:{prepend:"Estrenada"}},[o("b-form-select",{model:{value:t.movie.watched,callback:function(e){t.$set(t.movie,"watched",e)},expression:"movie.watched"}},[o("b-form-select-option",{attrs:{value:"0"}},[t._v("No")]),o("b-form-select-option",{attrs:{value:"1"}},[t._v("Sí")])],1)],1)],1)],1)],1)},M=[],y={name:"DetailModal",props:["movie"],computed:{...Object(l["b"])(["stores"])}},k=y,x=Object(m["a"])(k,_,M,!1,null,null,null),D=x.exports,S=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-modal",{attrs:{id:"options-modal",title:"Opciones","ok-only":""}},[o("b-row",{staticClass:"mb-3"},[o("b-col",[o("b-alert",{attrs:{variant:"info",show:""}},[t.exportCode?t._e():o("b-button",{attrs:{block:"",variant:"info"},on:{click:t.exportCollection}},[t._v("Exportar colección")]),t.exportCode?o("b-textarea",{attrs:{rows:"6",value:t.exportCode}}):t._e(),t.exportCode?o("b-button",{attrs:{block:""},on:{click:t.clearExportCode}},[t._v("Cerrar")]):t._e()],1)],1)],1),o("b-row",{staticClass:"mb-3"},[o("b-col",[o("b-alert",{attrs:{variant:"warning",show:""}},[t.showImportTextarea?t._e():o("b-button",{attrs:{block:"",variant:"warning"},on:{click:function(e){t.showImportTextarea=!0}}},[t._v("Importar colección")]),t.showImportTextarea?o("b-textarea",{attrs:{rows:"6"},model:{value:t.importCode,callback:function(e){t.importCode=e},expression:"importCode"}}):t._e(),t.importCode.length?o("b-button",{staticClass:"mr-2",attrs:{variant:"success"},on:{click:t.importCollection}},[t._v("Importar colección")]):t._e(),t.showImportTextarea?o("b-button",{on:{click:function(e){t.importCode="",t.showImportTextarea=!1}}},[t._v("Cancelar")]):t._e(),t.importCode.length?o("div",{staticClass:"text-center mt-2"},[o("small",[o("strong",[t._v("¡Esto sobrescribirá la colección actual! ¡No se puede deshacer!")])])]):t._e()],1)],1)],1),o("b-row",[o("b-col",[o("b-alert",{attrs:{variant:"danger",show:""}},[o("h5",[o("b-icon-exclamation-triangle"),t._v(" Zona peligrosa")],1),o("hr"),o("b-button",{attrs:{variant:"danger",block:""},on:{click:t.clearCollection}},[t._v("Eliminar la colección al completo")])],1)],1)],1)],1)},E=[],O={name:"OptionsModal",mixins:[r],computed:{...Object(l["b"])(["movieCollection","totalSpent"])},data:function(){return{showImportTextarea:!1,importCode:"",exportCode:""}},methods:{clearCollection(){confirm("Vas a ELIMINAR POR COMPLETO la colección ¿estás seguro/a?")&&(this.$store.commit("clearCollection"),this.showToast("Colección eliminada","Se ha eliminado la colección al completo","success"))},exportCollection(){const t=JSON.stringify({movieCollection:this.movieCollection,totalSpent:this.totalSpent});this.exportCode=btoa(t)},clearExportCode(){this.exportCode=""},importCollection(){const t=atob(this.importCode);try{const e=JSON.parse(t);e.movieCollection=e.movieCollection.map(t=>(t.id||(t.id=this.newId()),"undefined"===typeof t.watched?t.watched=1:t.watched=!!+t.watched,t.addDate?t.addDate=+t.addDate:t.addDate=Date.now(),t)),this.$store.commit("importCollection",e),this.showToast("Importado","Colección importada con éxito","success")}catch(e){console.error(e)}}}},T=O,$=Object(m["a"])(T,S,E,!1,null,null,null),P=$.exports,I=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-modal",{attrs:{title:"Añadir película",id:"add-movie-modal"}},[o("b-input-group",{attrs:{size:"md",prepend:"Título"}},[o("b-form-input",{attrs:{id:"new-movie-title-modal"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addMovie.apply(null,arguments)}},model:{value:t.movie.title,callback:function(e){t.$set(t.movie,"title",e)},expression:"movie.title"}})],1),o("b-input-group",{staticClass:"mt-2",attrs:{size:"md",prepend:"Precio",append:"€"}},[o("b-form-input",{on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addMovie.apply(null,arguments)}},model:{value:t.movie.cost,callback:function(e){t.$set(t.movie,"cost",e)},expression:"movie.cost"}})],1),o("b-input-group",{staticClass:"mt-2",attrs:{prepend:"Tienda"}},[o("b-form-select",{model:{value:t.movie.store,callback:function(e){t.$set(t.movie,"store",e)},expression:"movie.store"}},[o("b-form-select-option",{attrs:{value:""}}),t._l(t.stores,(function(e,i){return o("b-form-select-option",{key:i,attrs:{value:i}},[t._v(t._s(e))])}))],2)],1),o("b-row",[o("b-col",{staticClass:"text-center mt-3",attrs:{sm:"12",md:"6","offset-md":"3"}},[o("b-button",{attrs:{block:"",variant:"success"},on:{click:t.addMovie}},[t._v("Añadir a la colección")])],1)],1)],1)},j=[],A={name:"AddMovieModal",mixins:[r],computed:{...Object(l["b"])(["stores"])},data:function(){return{movie:{title:"",cost:0,store:""}}},methods:{addMovie(){const t=this;if(!this.movie.title)return!1;this.$store.commit("addMovie",{id:t.newId(),title:t.movie.title,cost:t.movie.cost,store:t.movie.store}),document.querySelector("#new-movie-title-modal").focus(),this.showToast("Añadida",`Se ha añadido "${this.movie.title}" a la colección con un coste de ${this.movie.cost}€`,"success"),this.movie.title="",this.movie.cost=0,this.movie.store=""}}},N=A,R=Object(m["a"])(N,I,j,!1,null,null,null),z=R.exports,q=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-alert",{attrs:{variant:"info",show:""}},[o("strong",[t._v("Resumen")]),o("hr"),o("div",[t._v("Total de películas: "),o("strong",[t._v(t._s(t.totalMovies))])]),t.giftMovies?o("div",[t._v("Películas que me han regalado: "),o("strong",[t._v(t._s(t.giftMovies))])]):t._e(),t.unwatchedMovies?o("div",[t._v("Películas por estrenar: "),o("strong",[t._v(t._s(t.unwatchedMovies))])]):t._e(),o("div",[t._v("Dinero total invertido: "),o("strong",[t._v(t._s(t.totalSpent)+" €")])])])},F=[],L={name:"Resume",props:["totalMovies","giftMovies","unwatchedMovies","totalSpent"]},J=L,B=Object(m["a"])(J,q,F,!1,null,null,null),G=B.exports,H=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("nav",{staticClass:"navbar navbar-dark bg-dark mb-3"},[o("b-container",[o("a",{staticClass:"navbar-brand",attrs:{href:"#"}},[o("b-icon-film",{staticClass:"yellowgreen"}),t._v(" "),o("span",{staticClass:"d-none d-sm-inline-block"},[t._v("COLECCIÓN DE PELIS")])],1),o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.add-movie-modal",modifiers:{"add-movie-modal":!0}}],staticClass:"d-inline-block d-sm-none",attrs:{variant:"success"}},[o("b-icon-plus")],1),o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.options-modal",modifiers:{"options-modal":!0}}]},[o("b-icon-gear-fill"),t._v(" "),o("span",{staticClass:"d-none d-sm-inline-block"},[t._v("Opciones")])],1)],1)],1)},V=[],U={name:"Nav"},Y=U,Z=Object(m["a"])(Y,H,V,!1,null,null,null),K=Z.exports,Q={name:"App",components:{SuggestedMovie:p,DetailModal:C,EditModal:D,OptionsModal:P,AddMovieModal:z,Resume:G,Nav:K},mixins:[r],computed:{...Object(l["b"])(["movieCollection","totalSpent","suggestedToday","stores","exportCode","importCode","showImportTextarea"]),hasAnyFilter(){return this.filters.title.length||this.filters.cost.length}},watch:{movieCollection(){this.filterCollection()},hasAnyFilter(){this.filterCollection()},"filters.watched":function(){this.filterCollection()},qtyPerPage(){this.page=1,this.filterCollection()},"filters.sort.field":function(){this.filterCollection()},"filters.sort.order":function(){this.filterCollection()}},data:function(){return{page:1,qtyPerPage:15,addMovieData:{title:"",cost:0,store:""},editMovieData:{id:"",title:"",cost:"",watched:0,store:""},showFilters:!1,filters:{title:"",cost:"",watched:null,sort:{field:"addDate",order:-1}},detailMovie:{},filteredResults:{items:{},count:0}}},methods:{changePage(t){this.page=t,this.filterCollection()},showMovie(t){this.$store.dispatch({type:"getMovie",id:t}).then(t=>{this.detailMovie={ID:t.id,"Título":t.title,Coste:t.cost+" €",Tienda:this.stores[t.store],Estrenada:+t.watched?"Sí":"No","Fecha de inclusión":this.formatDate(t.addDate)}})},totalMovies(){return this.movieCollection.length},giftMovies(){let t=0;for(let e in this.movieCollection)0===+this.movieCollection[e].cost&&t++;return t},unwatchedMovies(){return Object.values(this.movieCollection).reduce((t,e)=>(+e.watched||t++,t),0)},formatDate(t){return new Date(t).toLocaleString().split(" ").shift()},sortItems(t){const e=this.filters.sort.order;return t.sort((t,o)=>t[this.filters.sort.field]>o[this.filters.sort.field]?e:t[this.filters.sort.field]<o[this.filters.sort.field]?-1*e:0)},filterCollection(){if(!this.movieCollection||!this.movieCollection.length)return!1;let t=this.movieCollection.slice().filter(this.filterItem);this.filters.sort.field,t=t.reverse();const e=t.length;t=t.splice(this.qtyPerPage*(this.page-1),this.qtyPerPage),this.filteredResults={items:t,count:e}},filterItem(t){let e=!0;return this.filters.title&&(t.title.toLowerCase().includes(this.filters.title.toLowerCase())||(e=!1)),this.filters.cost&&(this.evalCostFilter(t)||(e=!1)),null!==this.filters.watched&&+this.filters.watched!==+(t.watched||0)&&(e=!1),e},evalCostFilter(t){if(this.filters.cost.includes("&")){const e=this.filters.cost.split("&");return+t.cost>+e[0]&&+t.cost<+e[1]}return this.filters.cost.includes("<")?+t.cost<+this.filters.cost.replace("<",""):this.filters.cost.includes(">")?+t.cost>+this.filters.cost.replace(">",""):+t.cost===+this.filters.cost},newId(){return Math.random().toString().substring(2)+(new Date).getTime()},addMovie(){const t=this;if(!this.addMovieData.title)return!1;this.$store.commit("addMovie",{id:t.newId(),title:t.addMovieData.title,cost:t.addMovieData.cost,store:t.addMovieData.store}),document.querySelector("#new-movie-title").focus(),this.showToast("Añadida",`Se ha añadido "${this.addMovieData.title}" a la colección con un coste de ${this.addMovieData.cost}€`,"success"),this.addMovieData.title="",this.addMovieData.cost=0,this.addMovieData.store=""},clearCollection(){confirm("Vas a ELIMINAR POR COMPLETO la colección ¿estás seguro/a?")&&(this.$store.commit("clearCollection"),this.showToast("Colección eliminada","Se ha eliminado la colección al completo","success"))},removeMovie(t){this.$store.dispatch({type:"getMovie",id:t}).then(e=>{const o=e.title;confirm(`¿Eliminar de la colección "${o}"?`)&&(this.$store.commit("removeMovie",t),this.showToast("Eliminado",`Has eliminado "${o}"`,"success"))})},exportCollection(){const t=JSON.stringify({movieCollection:this.movieCollection,totalSpent:this.totalSpent});this.exportCode=btoa(t)},clearExportCode(){this.exportCode=""},importCollection(){const t=atob(this.importCode);try{const e=JSON.parse(t);e.movieCollection=e.movieCollection.map(t=>(t.id||(t.id=this.newId()),"undefined"===typeof t.watched?t.watched=1:t.watched=!!+t.watched,t.addDate?t.addDate=+t.addDate:t.addDate=Date.now(),t)),this.$store.commit("importCollection",e),this.showToast("Importado","Colección importada con éxito","success")}catch(e){console.error(e)}},editMovie(t){this.$store.dispatch({type:"getMovie",id:t}).then(t=>{this.editMovieData.id=t.id,this.editMovieData.title=t.title,this.editMovieData.cost=+t.cost,this.editMovieData.watched=+t.watched,this.editMovieData.store=t.store})},confirmEditMovie(){this.$store.commit("editMovie",{id:this.editMovieData.id,title:this.editMovieData.title,cost:+this.editMovieData.cost,watched:+this.editMovieData.watched,store:this.editMovieData.store}),this.showToast("Editado",`Se ha editado correctamente "${this.editMovieData.title}"`,"success")},resetEditMovie(){this.editMovieData.id="",this.editMovieData.title="",this.editMovieData.cost="",this.editMovieData.store=""},showToast(t,e,o){this.$bvToast.toast(e,{title:t,variant:o,solid:!0,toaster:"b-toaster-top-center"})},showMovieModal(t){this.showMovie(t),this.$bvModal.show("detail-movie-modal")}},mounted(){this.filterCollection()}},W=Q,X=(o("034f"),Object(m["a"])(W,s,a,!1,null,null,null)),tt=X.exports;const et=window.indexedDB.open("pelisDB",1);let ot=null;et.onerror=function(t){throw new Error(t.target.errorCode)},et.onupgradeneeded=function(t){ot=t.target.result;const e=ot.createObjectStore("collection",{keyPath:"id"});e.createIndex("id","id",{unique:!0})},et.onsuccess=function(t){ot=t.target.result,dt().then(t=>{if(pt.movieCollection=t,!t.length)return!1;pt.totalSpent=it(pt);const e=mt("config.suggestedToday");if(e&&at(e.date))rt(e.id).then(e=>{if(e)pt.suggestedToday={date:e.date,id:e.id};else{const e={date:Date.now(),id:t[st(0,t.length-1)].id};pt.suggestedToday=e,vt("config.suggestedToday",e)}});else{const e={date:Date.now(),id:t[st(0,t.length-1)].id};pt.suggestedToday=e,vt("config.suggestedToday",e)}})},i["default"].use(l["a"]);const it=t=>t.movieCollection.reduce((t,e)=>(t+=+e.cost,t),0),st=(t,e)=>Math.round(t+Math.random()*(e-t)),at=t=>{const e=new Date(+t).toLocaleString().split(" ").shift(),o=(new Date).toLocaleString().split(" ").shift();return e===o},lt=t=>new Promise((e,o)=>{const i=ot.transaction(["collection"],"readwrite"),s=i.objectStore("collection");Array.isArray(t)?t.forEach(t=>s.add(t)):s.add(t),i.onerror=t=>o(t),i.oncomplete=t=>e(!0)}),rt=t=>new Promise((e,o)=>{const i=ot.transaction(["collection"],"readonly"),s=i.objectStore("collection");s.get(t).onsuccess=t=>e(t.target.result)}),nt=t=>new Promise((e,o)=>{const i=ot.transaction(["collection"],"readwrite"),s=i.objectStore("collection");s.delete(t).onsuccess=t=>e(t)}),ct=(t,e)=>new Promise((o,i)=>{const s=ot.transaction(["collection"],"readwrite"),a=s.objectStore("collection");a.get(t).onsuccess=t=>{const i=t.target.result,s=Object.assign({},i,e);a.put(s).onsuccess=t=>{rt(s.id).then(t=>o(t))}}}),dt=()=>new Promise((t,e)=>{const o=ot.transaction(["collection"],"readonly"),i=o.objectStore("collection");i.getAll().onsuccess=e=>{e.target.result.sort((t,e)=>+t.addDate-+e.addDate),t(e.target.result)}}),ut=()=>new Promise((t,e)=>{const o=ot.transaction(["collection"],"readwrite"),i=o.objectStore("collection");i.clear().onsuccess=e=>{t(e)}}),mt=t=>JSON.parse(window.localStorage.getItem(t)),vt=(t,e)=>window.localStorage.setItem(t,JSON.stringify(e)),pt={movieCollection:{},totalSpent:0,suggestedToday:{date:null,id:""},stores:{amazon:"Amazon",elcorteingles:"El corte Inglés",fnac:"Fnac",cex:"Cex",carrefour:"Carrefour"}};var ft=new l["a"].Store({state:pt,mutations:{setCollection(t,e){t.movieCollection=e},addMovie(t,e){e.addDate=Date.now(),lt(e).then(()=>{t.movieCollection.push(e),t.totalSpent+=+e.cost})},clearCollection(t){ut().then(()=>{t.movieCollection=[],t.totalSpent=0})},removeMovie(t,e){nt(e).then(()=>{const o=t.movieCollection.findIndex(t=>t.id===e);i["default"].delete(t.movieCollection,o),t.totalSpent=it(t)})},importCollection(t,e){ut().then(o=>{lt(e.movieCollection).then(o=>{t.movieCollection=e.movieCollection,t.totalSpent=e.totalSpent})})},editMovie(t,e){ct(e.id,e).then(o=>{const s=t.movieCollection.findIndex(t=>t.id===e.id);i["default"].set(t.movieCollection,s,o),t.totalSpent=it(t)})}},actions:{getMovie({commit:t,state:e},o){return rt(o.id)}},modules:{},plugins:[]}),bt=o("5f5b"),ht=o("b1e0");i["default"].config.productionTip=!1,i["default"].use(bt["a"]),i["default"].use(ht["a"]),new i["default"]({store:ft,render:function(t){return t(tt)}}).$mount("#app")},"85ec":function(t,e,o){}});
//# sourceMappingURL=app.0434793e.js.map